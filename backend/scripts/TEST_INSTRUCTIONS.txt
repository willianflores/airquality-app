â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘                  INSTRUÃ‡Ã•ES DE TESTE - AIR QUALITY APP                â•‘
â•‘                     Sistema de AtualizaÃ§Ã£o DiÃ¡ria                      â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ CHECKLIST DE TESTE COMPLETO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â–¡ 1. INSTALAÃ‡ÃƒO DE DEPENDÃŠNCIAS
    cd /home/willianflores/localhost/airquality-app/backend/scripts
    pip install -r requirements.txt
    
    âœ“ Verificar: Sem erros de instalaÃ§Ã£o

â–¡ 2. CONFIGURAÃ‡ÃƒO DO AMBIENTE
    cp config.env.example config.env
    nano config.env
    
    Editar:
    - DB_PASSWORD (sua senha do PostgreSQL)
    - PURPLEAIR_API_KEY (sua chave da API)
    
    âœ“ Verificar: Arquivo config.env criado e editado

â–¡ 3. VERIFICAÃ‡ÃƒO DE SAÃšDE DO SISTEMA
    python3 health_check.py
    
    âœ“ Esperado: Todos os checks em verde ou amarelo
    âœ— Se vermelho: Corrigir problemas antes de continuar

â–¡ 4. TESTE DE DOWNLOAD (MANUAL)
    python3 getPurpleairApiHistoricalData.py
    
    âœ“ Esperado: 
       - "PerÃ­odo de download: ..." exibido
       - "Download concluÃ­do... X registros obtidos"
       - "Dados salvos com sucesso"
    
    âœ“ Verificar no banco:
       psql -h localhost -U postgres -d db_airquality \
         -c "SELECT MAX(time_stamp), COUNT(*) FROM sc_padata.tb_parealtimedata;"

â–¡ 5. TESTE DE PROCESSAMENTO (MANUAL)
    python3 runFuctions_server.py
    
    âœ“ Esperado:
       - "Obtendo dados brutos do banco..."
       - "Calculando mÃ©dias horÃ¡rias..."
       - "Calculando mÃ©dias diÃ¡rias..."
       - "âœ… Processamento concluÃ­do"
    
    âœ“ Verificar no banco:
       psql -h localhost -U postgres -d db_airquality \
         -c "SELECT MAX(date), COUNT(*) FROM hour;"
       psql -h localhost -U postgres -d db_airquality \
         -c "SELECT MAX(date), COUNT(*) FROM day;"

â–¡ 6. TESTE COMPLETO INTEGRADO
    python3 daily_update.py
    
    âœ“ Esperado:
       - "ETAPA 1: Download..." executada com sucesso
       - "ETAPA 2: Processamento..." executada com sucesso
       - "RESUMO FINAL: âœ… SUCESSO"
       - Exit code 0
    
    âœ“ Verificar logs:
       tail -f ../logs/daily_update.log

â–¡ 7. CONFIGURAÃ‡ÃƒO DO CRON JOB
    chmod +x setup_cron.sh
    ./setup_cron.sh
    
    âœ“ Verificar:
       crontab -l | grep daily_update
    
    âœ“ Esperado: Linha com "5 0 * * * ... daily_update.py"

â–¡ 8. VERIFICAÃ‡ÃƒO PÃ“S-INSTALAÃ‡ÃƒO
    python3 health_check.py
    
    âœ“ Esperado: Todos os checks OK (verde)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ› SOLUÃ‡ÃƒO DE PROBLEMAS COMUNS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PROBLEMA: "ModuleNotFoundError: No module named 'pandas'"
SOLUÃ‡ÃƒO: pip install -r requirements.txt

PROBLEMA: "connection to server failed: Connection refused"
SOLUÃ‡ÃƒO: 
  - Verificar se PostgreSQL estÃ¡ rodando: systemctl status postgresql
  - Verificar credenciais em config.env

PROBLEMA: "PURPLEAIR_API_KEY nÃ£o encontrada"
SOLUÃ‡ÃƒO: 
  - Editar config.env
  - Adicionar: PURPLEAIR_API_KEY=sua_chave_aqui

PROBLEMA: "Nenhum dado foi obtido da API PurpleAir"
SOLUÃ‡ÃƒO:
  - Verificar API key vÃ¡lida
  - Verificar conectividade: curl https://api.purpleair.com/v1/sensors/57177
  - Pode ser que sensores estejam offline (normal)

PROBLEMA: "Nenhum dado encontrado no banco"
SOLUÃ‡ÃƒO:
  - Executar primeiro: python3 getPurpleairApiHistoricalData.py
  - Verificar se dados foram inseridos no banco

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“Š VERIFICAÃ‡Ã•ES SQL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Conectar ao banco
psql -h localhost -U postgres -d db_airquality

# Verificar dados brutos (Ãºltimas 48h)
SELECT MAX(time_stamp) as ultimo_dado, 
       COUNT(*) as total_registros
FROM sc_padata.tb_parealtimedata
WHERE time_stamp >= NOW() - INTERVAL '48 hours';

# Verificar mÃ©dias horÃ¡rias (Ãºltimas 48h)
SELECT MAX(date) as ultima_hora,
       COUNT(*) as total_registros
FROM hour
WHERE date >= NOW() - INTERVAL '48 hours';

# Verificar mÃ©dias diÃ¡rias (Ãºltimos 7 dias)
SELECT MAX(date) as ultimo_dia,
       COUNT(*) as total_registros
FROM day
WHERE date >= NOW() - INTERVAL '7 days';

# Ver dados por municÃ­pio (hoje)
SELECT municipio, 
       AVG(pm2_5) as pm25_media,
       COUNT(*) as medicoes
FROM hour
WHERE date >= CURRENT_DATE
GROUP BY municipio
ORDER BY pm25_media DESC;

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ LOGS IMPORTANTES
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

# Log principal (formatado)
tail -f /home/willianflores/localhost/airquality-app/backend/logs/daily_update.log

# Log do cron (bruto)
tail -f /home/willianflores/localhost/airquality-app/backend/logs/cron_output.log

# Ver apenas erros
grep "ERROR\|âŒ" /home/willianflores/localhost/airquality-app/backend/logs/daily_update.log

# Ver Ãºltimas execuÃ§Ãµes
grep "RESUMO FINAL" /home/willianflores/localhost/airquality-app/backend/logs/daily_update.log | tail -10

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
âœ… CRITÃ‰RIOS DE SUCESSO
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Sistema estÃ¡ pronto quando:

âœ“ health_check.py retorna todos os checks OK
âœ“ ExecuÃ§Ã£o manual de daily_update.py termina com sucesso
âœ“ Dados aparecem nas 3 tabelas (tb_parealtimedata, hour, day)
âœ“ Cron job estÃ¡ configurado (crontab -l)
âœ“ Logs estÃ£o sendo gerados corretamente
âœ“ NÃ£o hÃ¡ erros nos logs das Ãºltimas 24h

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“ PRÃ“XIMOS PASSOS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. Aguardar primeira execuÃ§Ã£o automÃ¡tica (00:05 do prÃ³ximo dia)
2. Verificar logs no dia seguinte
3. Configurar monitoramento/alertas (opcional)
4. Configurar logrotate (ver README_DAILY_UPDATE.md)
5. Fazer backup do banco periodicamente

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
ğŸ“š DOCUMENTAÃ‡ÃƒO ADICIONAL
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

â€¢ QUICK_START.md         - InÃ­cio rÃ¡pido (5 minutos)
â€¢ README_DAILY_UPDATE.md - DocumentaÃ§Ã£o completa
â€¢ ARCHITECTURE.md        - Arquitetura do sistema
â€¢ CHANGES_SUMMARY.md     - Resumo das mudanÃ§as

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Data: 2025-11-09
VersÃ£o: 1.0

